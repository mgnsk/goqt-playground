version: "3.7"

networks:
  demonet:

services:
  go:
    image: go-sandbox:sandbox
    build:
      context: .
      dockerfile: images/go-sandbox/Dockerfile
      args:
        - USER
        - GROUP
        - UID
        - GID
        - DOCKER_GID
    hostname: go-sandbox
    environment:
      - GOPROXY=http://goproxy:3000
      - GOOS=linux
      - GOARCH=amd64
      - GO111MODULE=on
    volumes:
      - ./.go:/go
      - ./app:/app
      - ./qt:/qt
    stdin_open: yes
    tty: yes
    networks:
      - demonet
    depends_on:
      - goproxy

  goproxy:
    image: goproxy:sandbox
    build:
      context: .
      dockerfile: images/goproxy/Dockerfile
      args:
        - USER
        - UID
        - GID
    networks:
      - demonet
    ports:
      - 3000
    volumes:
      - ./.go:/go
